function addZero(t){return t=t<10?"0"+t:t}function formatTime(t){var n=parseInt(t/60),e=t-60*n;return"- "+addZero(n)+":"+addZero(e)}function getCenter(t){var n=t.segments[0].point.x,e=t.segments[1].point.x,o=t.segments[0].point.y,a=n+(e-n)/2,i=o+(t.segments[1].point.y-o)/2;return new paper.Point(a,i)}function getLastFourPoints(t){var n=t.segments;return[n[n.length-1].point,n[n.length-2].point,n[n.length-3].point,n[n.length-4].point]}function getMousePosition(t){return{x:t.clientX,y:t.clientY}}function getPoint(t,n){return t.segments[n].point}function randomInt(t,n=1){return Math.floor(Math.random()*t)+n}async function requestAudioAutoplay(t){try{await _player.el.play(),_player.isPlaying=!0,_canvas.requestTrackOnSuccess(t)}catch(n){playButtonOnSafari(t)}}function playButtonOnSafari(t){var n=$("#play-on-safari");n.css("display","flex"),n.click(function(){_canvas.requestTrackOnSuccess(t),_global.togglePlay(),n.remove()})}function setBodyInvert(t){t.invertColors&&$("body").addClass("invert-colors")}function setMatrixDimensions(t,n,e){return{rows:t,cols:n,length:e}}Math.getDistance=function(t,n,e,o){var a=e-t,i=o-n;return a*=a,i*=i,Math.sqrt(a+i)},Math.degrees=function(t){return 180*t/Math.PI};var setStyle=(t=1,n="transparent",e=2,o="transparent")=>{return{strokeWidth:t,strokeColor:n+"33",shadowBlur:e,shadowColor:n,fillColor:o,blendMode:"normal"}};function shuffle(t){for(let n=t.length-1;n>0;n--){let e=randomInt(n);[t[n],t[e]]=[t[e],t[n]]}return t}const _global={autoplayNext:()=>{var t=_player.next,n=_tracks[t].$track.attr("data-slug");_player.pause(),_global.unmount(),_controls.addLoadingState(),setTimeout(function(){_global.requestTrack(n)},1e3)},onAudioReadyToPlay:t=>{_player.change=!0,_player.onTimeUpdate(),_player.el.removeEventListener("canplaythrough",_global.onAudioReadyToPlay),_player.setupAnalyser(),_controls.update(),_controls.playVinyl(),_controls.removeLoadingState(),requestAudioAutoplay(t)},requestTrack:t=>{var n=window.location.href+"/"+t+".json";return $.ajax({url:n,type:"GET",dataType:"json",success:_global.requestTrackOnSuccess,error:_global.requestTrackOnError}),this},requestTrackOnSuccess:t=>{_player.onSuccessfulRequest(t).addEventListener("canplaythrough",_global.onAudioReadyToPlay(t))},requestTrackOnError:t=>{console.warn("Track not found")},timerInterval:()=>{if(_player.isSetup&&_player.isPlaying){var t=_player.duration,n=_player.timeLeft,e=_player.decimalTimeLeft;_controls.updateSeconds(n),_controls.updateSliders(e,t)}},togglePlay:()=>{_player.togglePlay(),_canvas.togglePlay(),_controls.togglePlayClass(),_controls.toggleVinyl()},reset:()=>{_player.change=!0,_player.reset(),_canvas.reset(),_controls.reset()},unmount:()=>{_player.change=!1,_player.pause(),_canvas.unmount(),_controls.unmount(),_controls.resetVinyl()}};var rangeX,rangeY,rt,prevVW,trackList=[];function initMouseEvents(){gridW=$(".tracks").outerWidth(),gridH=$(".tracks").outerHeight(),rangeY=gridH-vh;var t=((rangeX=gridW-vw)/-2).toFixed(4),n=(rangeY/-2).toFixed(4);$(".tracks").css("transform","translate("+t+"px, "+n+"px)"),$("body").mousemove(function(t){mousePos=getMousePosition(t),shiftTracksPosition()}),mouseOnTrack()}function shiftTracksPosition(){if(vw>vh){var t=(.25-mousePos.x/vw)*rangeX,n=(0-mousePos.y/vh)*rangeY;$(".tracks").css("transform","translate("+t+"px, "+n+"px)")}}function mouseOnTrack(){var t=$(".cursor__play, .cursor__pause");$(".track").on("mouseenter",function(){togglePlayPauseVisibility($(this))}).on("mousemove",function(){t.css({left:mousePos.x,top:mousePos.y})}).on("mouseleave",function(){t.css("visibility","hidden")}).on("click",function(){togglePlayPauseVisibility($(this))}),$(".track__text a").on("mouseenter",function(){t.css("visibility","hidden")}).on("mouseleave",function(){togglePlayPauseVisibility($(this))})}function togglePlayPauseVisibility(t){var n=$(".cursor__play"),e=$(".cursor__pause");t.hasClass("playing")?(n.css("visibility","hidden"),e.css("visibility","visible")):(e.css("visibility","hidden"),n.css("visibility","visible"))}var diffX=1,timeout=!1,delta=200;function initResizeEvents(){function t(){new Date-rt<delta?setTimeout(t,delta):(timeout=!1,checkDiffX(),resizeGrid())}prevVW=vw,$(window).resize(function(){rt=new Date,!1===timeout&&(timeout=!0,setTimeout(t,delta))})}function checkDiffX(){prevVW=vw,vw=$(window).width(),vh=$(window).height(),diffX=vw/prevVW}function resizeGrid(){gridW=$(".tracks").outerWidth(),gridH=$(".tracks").outerHeight(),rangeX=gridW-vw,rangeY=gridH-vh}var _loading={bar:{},index:0,length:0,trackList:[],init:function(){this.intro=$("#intro-loading"),this.container=$(".intro-loading__container"),this.bar=$("#loading-white"),this.tracks=$(".tracks"),hasIntro||this.tracks.removeClass("loading")},progress:function(t){var n=this;n.length=Math.min(t.length,9);for(var e=0;e<this.length;e++){var o=new Audio;o.addEventListener("canplaythrough",function(){n.increase(),n.index>=n.length&&n.done()}),o.src=t[e],o.load(),this.trackList.push(o)}},increase:function(){this.index++,this.bar.css("width",100/this.length*this.index+"%")},done:function(){_player.setTrackCount(this.length),setTimeout(()=>{this.container.addClass("open"),this.intro.addClass("fade-out")},1500),setTimeout(()=>{this.intro.remove(),this.tracks.removeClass("loading")},3e3)},loadTracks:()=>{var t=window.location.href+"/tracks.json";$.ajax({url:t,type:"GET",dataType:"json",success:t=>{_loading.progress(t.tracks)},error:t=>{console.log(t),_loading.progress(t)}})},skip:function(){this.intro.remove()}};function initNavigationEvents(){$(".nav__item, .nav__item-mobile").click(triggerClassOnNavigation),$(".controls__back").click(triggerClassOnBack),$(".controls__menu").click(triggerClassOnMenu),$(".controls__close").click(triggerClassOnClose)}var vw,vh,gridW,gridH,triggerClassOnMenu=function(){$("main").addClass("show-menu"),$("body").addClass("show-home-mobile")},triggerClassOnClose=function(){$("main").removeClass("show-menu")},triggerClassOnNavigation=function(){var t=$(this),n=currentSection?1e3:5,e=currentSection?n:1e3,o=e+1e3,a=t.attr("data-target"),i="."+a,r="show-"+a;!t.hasClass("active")&&(onAnimationOutStart(),setTimeout(()=>onAnimationOutEnd(t,i,r),n),setTimeout(()=>onAnimationInStart(i),e),setTimeout(()=>onAnimationInEnd(),o))},triggerClassOnBack=function(){var t=currentSection?1e3:5;onAnimationOutStart(),setTimeout(()=>onAnimationCloseSection(),t)};function onAnimationOutStart(){$(currentSection).addClass("animate-out")}function onAnimationOutEnd(t,n,e){$(currentSection).removeClass("animate-out"),$(n).addClass("animate-pre"),$("body").removeClass("show-index show-contact show-home-mobile").addClass(e),$(".nav__item, .nav__item-mobile").removeClass("active"),t.addClass("active")}function onAnimationInStart(t){currentSection=t,$(currentSection).removeClass("animate-pre").addClass("animate-in")}function onAnimationInEnd(){$(currentSection).removeClass("animate-in")}function onAnimationCloseSection(){$(currentSection).removeClass("animate-out"),currentSection=null,$("body").removeClass(),$("main").removeClass("show-menu"),$(".nav__item, .nav__item-mobile").removeClass("active")}var _player,_canvas,_controls,mousePos={x:0,y:0},prevMousePos={x:0,y:0},currentSection=null,hasIntro=!0,numberOfTracks=25,_tracks=[];window.onload=function(){vw=$(window).width(),vh=$(window).height(),_loading.init(),hasIntro?_loading.loadTracks():_loading.skip(),_player=new Player(numberOfTracks),_canvas=new Canvas,(_controls=new Controls).init();for(var t=0;t<numberOfTracks;t++){var n=t+1,e=new Track(t,n,"#track-"+n,"#index-track-"+n);e.init(),_tracks.push(e)}vw<vh&&($("main").scrollLeft(vw/4),$("main").scrollTop(vh)),initNavigationEvents(),initResizeEvents(),initMouseEvents(),_player.volume=.7};